import{b as T,u as k}from"./vue-router-DQ646c9T.js";import{u as B}from"./noteStore-GpHaBAYh.js";import{u as E}from"./index-ClTo44m5.js";/* empty css                 */import{O as D,b as z}from"./element-plus-icons-DT1t6uiv.js";import{_ as M}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as $,b as j,f as U}from"./element-plus-Bsbl4o2M.js";import{r as v,w as x,H as I,I as S,J as d,Z as i,M as p,u as o,S as y,W as V,c as C,B as R,X as A}from"./vue-BsGzy4bG.js";import"./pinia-Daj9vj9Q.js";const H={class:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4"},J={class:"flex gap-3"},O={class:"mb-6"},W={class:"editor-container rounded-lg overflow-hidden"},X={__name:"NoteEditor",props:{noteId:{type:[Number,String],default:null},initialTitle:{type:String,default:""},initialContent:{type:String,default:""},initialTags:{type:Array,default:()=>[]}},emits:["save","cancel"],setup(h,{emit:f}){const{isDarkMode:a}=E(),l=h,u=f,n=v(l.initialTitle),s=v(l.initialContent),r=v(l.initialTags.join(", ")),m=v(!1);x(()=>l.initialTitle,e=>{n.value=e}),x(()=>l.initialContent,e=>{s.value=e}),x(()=>l.initialTags,e=>{r.value=e.join(", ")},{deep:!0});const b=async()=>{m.value=!0;try{if(!n.value.trim()&&!s.value.trim()&&!r.value.trim())l.noteId?u("delete",l.noteId):u("cancel");else{const t={title:n.value,content:s.value,tags:r.value.split(",").map(c=>c.trim()).filter(c=>c)};u("save",t)}}catch(e){console.error("保存笔记失败:",e)}finally{m.value=!1}},_=()=>{u("cancel")};return(e,t)=>{const c=$,w=j,N=U;return S(),I("div",{class:p(["note-editor rounded-xl shadow-lg p-8 transition-all duration-300",{"bg-white":!o(a),"bg-gray-800":o(a)}])},[d("div",H,[i(c,{modelValue:n.value,"onUpdate:modelValue":t[0]||(t[0]=g=>n.value=g),placeholder:"请输入笔记标题",class:p(["text-2xl font-bold flex-1 transition-colors",{"bg-transparent border-none":!o(a),"bg-transparent border-none text-white":o(a)}]),size:"large"},null,8,["modelValue","class"]),d("div",J,[i(N,{onClick:b,loading:m.value,type:"primary",size:"large",round:"",class:"bg-gradient-to-r from-blue-500 to-purple-500 border-0 hover:shadow-lg transition-all"},{default:y(()=>[i(w,{class:"mr-1"},{default:y(()=>[i(o(D))]),_:1}),t[3]||(t[3]=V(" 保存 ",-1))]),_:1},8,["loading"]),i(N,{onClick:_,size:"large",round:"",class:p({"bg-gray-100 text-gray-800 hover:bg-gray-200":!o(a),"bg-gray-700 text-gray-200 hover:bg-gray-600":o(a)})},{default:y(()=>[i(w,{class:"mr-1"},{default:y(()=>[i(o(z))]),_:1}),t[4]||(t[4]=V(" 取消 ",-1))]),_:1},8,["class"])])]),d("div",O,[i(c,{modelValue:r.value,"onUpdate:modelValue":t[1]||(t[1]=g=>r.value=g),placeholder:"请输入标签，用逗号分隔",class:p(["w-full rounded-lg transition-all",{"bg-gray-50 border-gray-200":!o(a),"bg-gray-700 border-gray-600 text-white":o(a)}])},null,8,["modelValue","class"])]),d("div",W,[i(c,{modelValue:s.value,"onUpdate:modelValue":t[2]||(t[2]=g=>s.value=g),type:"textarea",rows:25,placeholder:"开始编写您的笔记...",class:p(["w-full resize-none transition-colors",{"bg-gray-50 border-gray-200 text-gray-800":!o(a),"bg-gray-700 border-gray-600 text-white":o(a)}])},null,8,["modelValue","class"])])],2)}}},Z=M(X,[["__scopeId","data-v-8ab53b4a"]]),q={class:"container mx-auto px-4 py-12"},F={class:"max-w-4xl mx-auto"},G={class:"text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent mb-10 text-center"},le={__name:"NoteEditorView",setup(h){const f=T(),a=k(),l=B(),{isDarkMode:u}=E(),n=v(null),s=C(()=>f.name==="NoteCreate"),r=C(()=>s.value?null:parseInt(f.params.id)),m=async e=>{try{s.value?await l.createNote(e):await l.updateNote(r.value,e),a.push("/notes")}catch(t){console.error("保存笔记失败:",t)}},b=()=>{a.push("/notes")},_=async e=>{try{await l.deleteNote(e),a.push("/notes")}catch(t){console.error("删除笔记失败:",t)}};return R(async()=>{if(!s.value&&r.value)try{n.value=await l.fetchNoteById(r.value)}catch(e){console.error("获取笔记详情失败:",e),a.push("/notes")}}),(e,t)=>(S(),I("div",{class:p(["min-h-screen transition-colors duration-300",{"bg-gray-50":!o(u),"bg-gray-950":o(u)}])},[d("div",q,[d("div",F,[d("h1",G,A(s.value?"创建新笔记":"编辑笔记"),1),i(Z,{"note-id":r.value,"initial-title":n.value?.title||"","initial-content":n.value?.content||"","initial-tags":n.value?.tags||[],onSave:m,onCancel:b,onDelete:_},null,8,["note-id","initial-title","initial-content","initial-tags"])])])],2))}};export{le as default};
