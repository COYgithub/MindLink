import"./index-ClTo44m5.js";/* empty css                        *//* empty css               *//* empty css                  */import{u as G}from"./vue-router-DQ646c9T.js";import{B as H,X as J}from"./element-plus-icons-DT1t6uiv.js";/* empty css                 *//* empty css                    */import{_ as R}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{v as O,l as W,j as Y,m as Z,f as j,n as K,o as Q,p as ee,q as te,b as ae,r as le,s as oe,h as M,t as ne}from"./element-plus-Bsbl4o2M.js";import{r as z,w as I,T as se,I as c,H as E,R as y,U,S as a,Z as l,J as d,X as w,Y as F,ae as X,W as m,c as ie,B as re,u as N}from"./vue-BsGzy4bG.js";import{u as ue}from"./noteStore-GpHaBAYh.js";import"./pinia-Daj9vj9Q.js";const de={class:"note-list"},ce=["onClick"],pe={class:"tags-container"},ge={__name:"NoteList",props:{page:{type:Number,default:1},pageSize:{type:Number,default:10},tags:{type:Array,default:()=>[]},list:{type:Array,default:()=>[]},total:{type:Number,default:0},loading:{type:Boolean,default:!1}},emits:["page-change","note-click","view","edit","delete"],setup(_,{emit:h}){const s=_,i=h,p=z(s.page),u=z(s.pageSize);I(()=>s.page,e=>{p.value=e}),I(()=>s.pageSize,e=>{u.value=e});const S=e=>!e||!Array.isArray(e)?[]:e.slice(0,2),g=e=>!e||!Array.isArray(e)?0:Math.max(0,e.length-2),V=e=>e?new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-",x=e=>{i("note-click",e)},T=e=>{p.value=e,i("page-change",{page:e,pageSize:u.value,tags:s.tags})},B=e=>{u.value=e,p.value=1,i("page-change",{page:1,pageSize:e,tags:s.tags})},$=e=>{i("view",e)},D=e=>{i("edit",e)},L=e=>{K.confirm(`确定要删除笔记"${e.title}"吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{i("delete",e)}).catch(()=>{})};return(e,r)=>{const o=W,t=Y,f=j,C=Z,P=Q,A=te,b=ee,v=O;return se((c(),E("div",de,[_.list.length>0?(c(),y(P,{key:0,data:_.list,style:{width:"100%"},"scroll-y":400,height:"400"},{default:a(()=>[l(o,{prop:"title",label:"标题","min-width":"200"},{default:a(({row:n})=>[d("span",{class:"note-title",onClick:k=>x(n.id)},w(n.title),9,ce)]),_:1}),l(o,{label:"标签","min-width":"200"},{default:a(({row:n})=>[d("div",pe,[(c(!0),E(F,null,X(S(n.tags),(k,q)=>(c(),y(t,{key:q,size:"small",class:"tag-item"},{default:a(()=>[m(w(k),1)]),_:2},1024))),128)),g(n.tags)>0?(c(),y(t,{key:0,size:"small",type:"info",class:"tag-item"},{default:a(()=>[m(" +"+w(g(n.tags)),1)]),_:2},1024)):U("",!0)])]),_:1}),l(o,{prop:"created_at",label:"创建时间",width:"180"},{default:a(({row:n})=>[m(w(V(n.created_at)),1)]),_:1}),l(o,{label:"操作",width:"200",fixed:"right"},{default:a(({row:n})=>[l(C,null,{default:a(()=>[l(f,{type:"primary",size:"small",onClick:k=>$(n)},{default:a(()=>[...r[2]||(r[2]=[m(" 查看 ",-1)])]),_:1},8,["onClick"]),l(f,{type:"warning",size:"small",onClick:k=>D(n)},{default:a(()=>[...r[3]||(r[3]=[m(" 编辑 ",-1)])]),_:1},8,["onClick"]),l(f,{type:"danger",size:"small",onClick:k=>L(n)},{default:a(()=>[...r[4]||(r[4]=[m(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])):_.loading?U("",!0):(c(),y(A,{key:1,description:"暂无笔记数据"})),_.total>0?(c(),y(b,{key:2,modelValue:p.value,"onUpdate:modelValue":r[0]||(r[0]=n=>p.value=n),"page-size":u.value,"onUpdate:pageSize":r[1]||(r[1]=n=>u.value=n),total:_.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:T,onSizeChange:B,class:"pagination"},null,8,["modelValue","page-size","total"])):U("",!0)])),[[v,_.loading]])}}},me=R(ge,[["__scopeId","data-v-a9263298"]]),_e={class:"note-list-view"},fe={class:"page-header"},ve={class:"filter-section"},he={class:"filter-row"},ye={class:"filter-item"},Ce={class:"filter-actions"},ke={class:"list-section"},Ne={__name:"NoteListView",setup(_){const h=G(),s=ue(),i=z(1),p=z(10),u=z([]),S=ie(()=>s.allTags),g=async()=>{try{await s.fetchNotes(i.value,p.value,u.value)}catch(o){M.error(o.message||"获取笔记列表失败")}},V=({page:o,pageSize:t,tags:f})=>{i.value=o,p.value=t,u.value=f,g()},x=()=>{i.value=1,g()},T=()=>{u.value=[],i.value=1,g()},B=()=>{g()},$=()=>{h.push("/notes/new")},D=o=>{o&&h.push(`/notes/${o}`)},L=o=>{h.push(`/notes/${o.id}`)},e=o=>{h.push(`/notes/${o.id}/edit`)},r=async o=>{try{await s.deleteNote(o.id),M.success("删除成功"),s.list.length===0&&i.value>1&&i.value--,g()}catch(t){M.error(t.message||"删除失败")}};return re(()=>{g()}),(o,t)=>{const f=ae,C=j,P=ne,A=le,b=oe;return c(),E("div",_e,[d("div",fe,[t[2]||(t[2]=d("h2",null,"笔记管理",-1)),l(C,{type:"primary",onClick:$},{default:a(()=>[l(f,null,{default:a(()=>[l(N(H))]),_:1}),t[1]||(t[1]=m(" 新建笔记 ",-1))]),_:1})]),d("div",ve,[l(b,{shadow:"never"},{default:a(()=>[d("div",he,[d("div",ye,[t[3]||(t[3]=d("label",null,"标签筛选：",-1)),l(A,{modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=v=>u.value=v),multiple:"","collapse-tags":"","collapse-tags-tooltip":"",placeholder:"选择标签进行筛选",style:{width:"300px"},onChange:x},{default:a(()=>[(c(!0),E(F,null,X(S.value,v=>(c(),y(P,{key:v,label:v,value:v},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),d("div",Ce,[l(C,{onClick:T},{default:a(()=>[...t[4]||(t[4]=[m("清空筛选",-1)])]),_:1}),l(C,{type:"primary",onClick:B},{default:a(()=>[l(f,null,{default:a(()=>[l(N(J))]),_:1}),t[5]||(t[5]=m(" 刷新 ",-1))]),_:1})])])]),_:1})]),d("div",ke,[l(b,{shadow:"never"},{default:a(()=>[l(me,{page:i.value,"page-size":p.value,tags:u.value,list:N(s).list,total:N(s).total,loading:N(s).loading,onPageChange:V,onNoteClick:D,onView:L,onEdit:e,onDelete:r},null,8,["page","page-size","tags","list","total","loading"])]),_:1})])])}}},Ae=R(Ne,[["__scopeId","data-v-240bb35f"]]);export{Ae as default};
